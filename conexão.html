<html><head><base href="http://localhost/" />
<title>Conexão APE</title>
<style>
:root {
    --primary-color: #e3f2fd;
    --secondary-color: #1976d2;
}

body {
    font-family: 'Segoe UI', Arial, sans-serif;
    margin: 0;
    padding: 0;
    background: var(--primary-color);
}

.login-container {
    width: 100%;
    height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

.logo-image {
    max-width: 200px;
    height: auto;
    margin-bottom: 20px;
    border-radius: 10px;
}

.app-title {
    font-size: 2.5em;
    color: var(--secondary-color);
    margin-bottom: 10px;
}

.subtitle {
    font-size: 1.2em;
    color: #666;
    margin-bottom: 30px;
}

.login-form {
    background: white;
    padding: 40px;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0,0,0,0.1);
    width: 300px;
}

.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    margin-bottom: 5px;
    color: #333;
}

.form-group input {
    width: 100%;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 5px;
}

.btn {
    width: 100%;
    padding: 12px;
    background: var(--secondary-color);
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 1em;
}

.btn:hover {
    background: #1565c0;
}

.register-link {
    text-align: center;
    margin-top: 20px;
}

.footer {
    position: fixed;
    bottom: 20px;
    width: 100%;
    text-align: center;
    color: #666;
}

/* Feed Styles */
.main-container {
    display: none;
    margin-left: 80px;
}

.sidebar {
    position: fixed;
    left: 0;
    top: 0;
    height: 100vh;
    width: 80px;
    background: var(--secondary-color);
    padding: 20px 0;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.sidebar-btn {
    width: 50px;
    height: 50px;
    margin: 10px 0;
    border: none;
    background: transparent;
    cursor: pointer;
    color: white;
    font-size: 24px;
}

.logout-btn {
    margin-top: auto;
}

.feed {
    padding: 20px;
    max-width: 800px;
    margin: 0 auto;
}

.post {
    background: white;
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 20px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

.post-header {
    display: flex;
    align-items: center;
    margin-bottom: 15px;
}

.profile-pic {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    margin-right: 15px;
}

.admin-post {
    border: 2px solid gold;
}

.crown-icon {
    color: gold;
    margin-left: 5px;
}

/* New Styles for Reactions and Comments */
.post-actions {
    margin-top: 15px;
    display: flex;
    gap: 10px;
}

.reaction-btn {
    background: none;
    border: none;
    cursor: pointer;
    padding: 5px 10px;
    display: flex;
    align-items: center;
    gap: 5px;
    border-radius: 5px;
}

.reaction-btn:hover {
    background: #f0f0f0;
}

.comment-section {
    margin-top: 15px;
    border-top: 1px solid #eee;
    padding-top: 15px;
}

.comment-input {
    width: 100%;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 5px;
    margin-bottom: 10px;
}

.comment {
    padding: 10px;
    background: #f9f9f9;
    border-radius: 5px;
    margin-bottom: 5px;
}

/* Modal Styles */
.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.5);
}

.modal-content {
    background: white;
    width: 80%;
    max-width: 500px;
    margin: 50px auto;
    padding: 20px;
    border-radius: 10px;
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
}

.close-btn {
    background: none;
    border: none;
    font-size: 24px;
    cursor: pointer;
}

.post-options {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 10px;
    margin-bottom: 20px;
}

.post-option {
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 5px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 10px;
}

.post-option i {
    font-size: 20px;
}

.real-time {
    position: fixed;
    top: 20px;
    right: 20px;
    background: white;
    padding: 10px;
    border-radius: 5px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

.link-preview {
    margin: 10px 0;
    border: 1px solid #ddd;
    border-radius: 5px;
    padding: 10px;
}

.preview-card {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px;
    background: #f5f5f5;
    border-radius: 5px;
    margin-top: 5px;
}

.preview-card i {
    color: var(--secondary-color);
}

.radio-player {
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 10px;
}

.radio-player iframe {
    max-width: 100%;
    border-radius: 8px;
}
</style>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>

<div class="login-container" id="loginPage">
    <img src="https://i.ibb.co/kKVNFQ5/ap9-Uvj6t-Txu-URSks-Gviknw.jpg" 
         alt="Conexão APE Logo" 
         class="logo-image"
         width="200"
         height="200">
    <h1 class="app-title">Conexão APE</h1>
    <p class="subtitle">Adoradores Por Excelência</p>
    <div class="login-form">
        <div class="form-group">
            <label>ID:</label>
            <input type="text" id="loginId">
        </div>
        <div class="form-group">
            <label>Senha:</label>
            <input type="password" id="loginPassword">
        </div>
        <button class="btn" onclick="login()">Entrar</button>
        <div class="register-link">
            <a href="#" onclick="showRegister()">Cadastrar-se</a>
        </div>
    </div>
</div>

<div class="main-container" id="mainPage">
    <div class="real-time" id="realTime"></div>
    
    <div class="sidebar">
        <button class="sidebar-btn" onclick="showPublishModal()">
            <i class="fas fa-pen"></i>
        </button>
        <button class="sidebar-btn" onclick="showProfileModal()">
            <i class="fas fa-user"></i>
        </button>
        <button class="sidebar-btn" onclick="showRadioPlayer()">
            <i class="fas fa-music"></i>
        </button>
        <button class="sidebar-btn" onclick="confirmYouTube()">
            <i class="fab fa-youtube"></i>
        </button>
        <button class="sidebar-btn logout-btn" onclick="logout()">
            <i class="fas fa-sign-out-alt"></i>
        </button>
    </div>

    <div class="feed" id="feed"></div>
</div>

<!-- Modals -->
<div class="modal" id="registerModal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Cadastro</h2>
            <button class="close-btn" onclick="closeModal('registerModal')">&times;</button>
        </div>
        <div class="form-group">
            <label>Nome/Apelido:</label>
            <input type="text" id="regName">
        </div>
        <div class="form-group">
            <label>Data de Nascimento:</label>
            <input type="date" id="regBirth">
        </div>
        <div class="form-group">
            <label>Idade:</label>
            <input type="number" id="regAge">
        </div>
        <div class="form-group">
            <label>ID:</label>
            <input type="text" id="regId">
        </div>
        <div class="form-group">
            <label>Senha:</label>
            <input type="password" id="regPassword">
        </div>
        <div class="form-group">
            <label>Perfil Smule:</label>
            <input type="text" id="regSmule">
        </div>
        <button class="btn" onclick="register()">Cadastrar</button>
    </div>
</div>

<div class="modal" id="publishModal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Publicar</h2>
            <button class="close-btn" onclick="closeModal('publishModal')">&times;</button>
        </div>
        <div class="post-options">
            <div class="post-option" onclick="handleTextPost()">
                <i class="fas fa-font"></i>
                <span>Texto</span>
            </div>
            <div class="post-option" onclick="handleFileUpload()">
                <i class="fas fa-file-upload"></i>
                <span>Escolher Arquivo</span>
            </div>
        </div>
        <textarea id="postText" style="width: 100%; height: 100px; margin-bottom: 10px;" placeholder="O que você quer compartilhar?"></textarea>
        <button class="btn" onclick="publishPost()">Publicar</button>
        <button class="btn" style="background: #666; margin-top: 10px;" onclick="closeModal('publishModal')">Cancelar</button>
    </div>
</div>

<div class="modal" id="profileModal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Meu Perfil</h2>
            <button class="close-btn" onclick="closeModal('profileModal')">&times;</button>
        </div>
        <div class="form-group">
            <label>Foto de Perfil:</label>
            <input type="file" id="profilePic" accept="image/*">
            <img id="profilePreview" style="width: 100px; height: 100px; border-radius: 50%; margin-top: 10px; display: none;">
        </div>
        <div class="form-group">
            <label>Nome/Apelido:</label>
            <input type="text" id="profileName">
        </div>
        <div class="form-group">
            <label>Data de Nascimento:</label>
            <input type="date" id="profileBirth">
        </div>
        <div class="form-group">
            <label>Idade:</label>
            <input type="number" id="profileAge">
        </div>
        <div class="form-group">
            <label>Perfil Smule:</label>
            <input type="text" id="profileSmule">
        </div>
        <button class="btn" onclick="saveProfile()">Salvar</button>
    </div>
</div>

<div class="modal" id="userProfileModal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Perfil do Usuário</h2>
            <button class="close-btn" onclick="closeModal('userProfileModal')">&times;</button>
        </div>
        <div id="userProfileContent"></div>
        <div id="blockUserSection"></div>
    </div>
</div>

<div class="modal" id="radioModal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Rádio Gospel</h2>
            <button class="close-btn" onclick="closeModal('radioModal')">&times;</button>
        </div>
        <div class="radio-player">
            <table width="207" border="0">
                <tbody>
                    <tr>
                        <td><a href="http://www.radiogospelmix.com.br" target="_blank"><img src="https://s3-sa-east-1.amazonaws.com/radiofacil-upload/1667/editor/3592dd1ca32134eda1575a2e9e72bcf5.png" alt="Radio Gospel Mix logo" width="207" height="auto"></a></td>
                    </tr>
                    <tr>
                        <td align="center">
                            <iframe src="https://d6ojw9st89o3o.cloudfront.net/BRGallery/index.php/player/view/flat;65;31;c2Vydmlkb3IzMy5icmxvZ2ljLmNvbS9hcHAucGxheWVyLnBocD9hZGRyZXNzPXNlcnZpZG9yMzMuYnJsb2dpYy5jb20mcG9ydD04MTky;true" 
                                    border="0" 
                                    scrolling="no" 
                                    frameborder="0" 
                                    allowTransparency="true" 
                                    style="background-color: transparent;" 
                                    width="65" 
                                    height="31">
                            </iframe>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<div class="modal" id="youtubeConfirmModal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Abrir Canal do YouTube</h2>
            <button class="close-btn" onclick="closeModal('youtubeConfirmModal')">&times;</button>
        </div>
        <p>Você será direcionado ao canal do YouTube do Grupo APE. Deseja continuar?</p>
        <div style="display: flex; gap: 10px; justify-content: center; margin-top: 20px;">
            <button class="btn" onclick="openYouTube()" style="width: auto;">Confirmar</button>
            <button class="btn" onclick="closeModal('youtubeConfirmModal')" style="width: auto; background: #666;">Cancelar</button>
        </div>
    </div>
</div>

<div class="footer">
    Desenvolvido por Fernando Carvalho - ®2024
</div>

<script>
let currentUser = null;
const users = [
    { id: 'admin', password: 'm5l5ndr5', isAdmin: true }
];
const posts = [];

function updateRealTime() {
    const now = new Date();
    const dateStr = now.toLocaleDateString();
    const timeStr = now.toLocaleTimeString();
    document.getElementById('realTime').textContent = `${dateStr} ${timeStr}`;
}

setInterval(updateRealTime, 1000);

function login() {
    const id = document.getElementById('loginId').value;
    const password = document.getElementById('loginPassword').value;
    
    const user = users.find(u => u.id === id && u.password === password);
    
    if (user) {
        currentUser = user;
        document.getElementById('loginPage').style.display = 'none';
        document.getElementById('mainPage').style.display = 'block';
        showWelcomeMessage();
        updateFeed();
    } else {
        alert('ID ou senha inválidos!');
    }
}

function showWelcomeMessage() {
    const modal = document.createElement('div');
    modal.className = 'modal';
    modal.style.display = 'block';
    
    modal.innerHTML = `
        <div class="modal-content">
            <div class="modal-header">
                <h2>Bem-vindo(a) ao Conexão APE!</h2>
                <button class="close-btn" onclick="this.closest('.modal').remove()">&times;</button>
            </div>
            <div style="max-height: 70vh; overflow-y: auto; padding: 20px;">
                <p>Estamos muito felizes em tê-lo(a) conosco neste espaço de adoração e comunhão. O Conexão APE foi criado para ser um ambiente seguro e saudável, onde todos podem crescer espiritualmente e compartilhar da fé em Cristo. Para garantir que isso aconteça, temos algumas regras importantes que pedimos que todos sigam:</p>
                
                <p>💥 Respeito às Igrejas: Aqui não discutimos placas de igreja, doutrinas bíblicas específicas ou debatemos palavras ministradas. Nosso foco é a unidade em Cristo.</p>
                
                <p>💥 Conversas Privadas: É proibido realizar conversas privadas entre membros sem consentimento. O respeito e a privacidade são fundamentais.</p>
                
                <p>💥 Conteúdos Espirituais: Evite temas que não agreguem valor à vida espiritual. Queremos que este espaço seja edificante para todos.</p>
                
                <p>💥 Publicações Inadequadas: Não permitimos postagens de bebidas alcoólicas, conteúdos sensuais ou qualquer material que vá contra a santidade de Deus.</p>
                
                <p>💥 Sem Política: Este é um grupo de adoração a Deus, então debates políticos não são permitidos.</p>
                
                <p>💥 Correntes e Pedidos de Dinheiro: É proibido enviar correntes, pedir dinheiro ou divulgar convites para outros grupos ou aplicativos.</p>
                
                <p>💥 Lives: Somente a administração do grupo pode abrir lives em nome do APE.</p>
                
                <p>Nossa única regra e fonte de fé é a Bíblia Sagrada, e nos prostramos somente diante de Jesus, nosso único Salvador.</p>
                
                <p>Que este seja um lugar onde a presença de Deus seja sentida, e juntos possamos crescer em comunhão e adoração. Sinta-se à vontade e seja abençoado(a)!</p>
                
                <p>Com amor,<br>Equipe Conexão APE</p>
            </div>
        </div>
    `;
    
    document.body.appendChild(modal);
}

function showRegister() {
    document.getElementById('registerModal').style.display = 'block';
}

function register() {
    const name = document.getElementById('regName').value;
    const birth = document.getElementById('regBirth').value;
    const age = document.getElementById('regAge').value;
    const id = document.getElementById('regId').value;
    const password = document.getElementById('regPassword').value;
    const smule = document.getElementById('regSmule').value;
    
    if (!name || !birth || !age || !id || !password) {
        alert('Por favor, preencha todos os campos!');
        return;
    }
    
    if (users.some(u => u.id === id)) {
        alert('Este ID já está em uso!');
        return;
    }
    
    users.push({
        name,
        birth,
        age,
        id,
        password,
        smule,
        isAdmin: false,
        blockedUsers: []
    });
    
    closeModal('registerModal');
    alert('Cadastro realizado com sucesso!');
}

function updateFeed() {
    const feed = document.getElementById('feed');
    feed.innerHTML = posts
        .filter(post => !currentUser.blockedUsers?.includes(post.user.id))
        .map(post => `
            <div class="post ${post.user.isAdmin ? 'admin-post' : ''}">
                <div class="post-header">
                    <img src="${post.user.profilePic || 'https://via.placeholder.com/50'}" 
                         class="profile-pic" 
                         onclick="showUserProfile('${post.user.id}')">
                    <div>
                        <strong>${post.user.name || post.user.id}</strong>
                        ${post.user.isAdmin ? '<i class="fas fa-crown crown-icon"></i>' : ''}
                        <br>
                        <small>${post.date}</small>
                    </div>
                </div>
                <div>${post.content}</div>
                <div class="post-actions">
                    <button class="reaction-btn" onclick="addReaction('${post.id}', 'like')">
                        <i class="fas fa-thumbs-up"></i>
                        <span>${post.reactions?.likes || 0}</span>
                    </button>
                    <button class="reaction-btn" onclick="addReaction('${post.id}', 'love')">
                        <i class="fas fa-heart"></i>
                        <span>${post.reactions?.loves || 0}</span>
                    </button>
                    <button class="reaction-btn" onclick="addReaction('${post.id}', 'dislike')">
                        <i class="fas fa-thumbs-down"></i>
                        <span>${post.reactions?.dislikes || 0}</span>
                    </button>
                    <button class="reaction-btn" onclick="reportPost('${post.id}')">
                        <i class="fas fa-flag"></i>
                    </button>
                </div>
                <div class="comment-section">
                    <input type="text" class="comment-input" 
                           placeholder="Adicionar comentário..."
                           onkeypress="handleCommentSubmit(event, '${post.id}')">
                    <div class="comments">
                        ${(post.comments || []).map(comment => `
                            <div class="comment">
                                <strong>${comment.user.name || comment.user.id}</strong>: ${comment.text}
                            </div>
                        `).join('')}
                    </div>
                </div>
                ${currentUser.isAdmin ? `
                    <button onclick="deletePost('${post.id}')" class="btn" style="width: auto; margin-top: 10px;">
                        <i class="fas fa-trash"></i> Deletar
                    </button>
                ` : ''}
            </div>
        `).join('');
}

function showPublishModal() {
    document.getElementById('publishModal').style.display = 'block';
}

function publishPost() {
    const content = document.getElementById('postText').value;
    if (!content) {
        alert('Por favor, escreva algo para publicar!');
        return;
    }
    
    const urlRegex = /(https?:\/\/[^\s]+)/g;
    const urls = content.match(urlRegex);
    let enrichedContent = content;
    
    if (urls) {
        urls.forEach(url => {
            enrichedContent = enrichedContent.replace(url, `
                <div class="link-preview">
                    <a href="${url}" target="_blank">${url}</a>
                    <div class="preview-card">
                        <i class="fas fa-link"></i>
                        <span>Link Preview</span>
                    </div>
                </div>
            `);
        });
    }
    
    posts.unshift({
        id: Date.now().toString(),
        user: currentUser,
        content: enrichedContent,
        date: new Date().toLocaleString(),
        reactions: {},
        comments: []
    });
    
    updateFeed();
    closeModal('publishModal');
    document.getElementById('postText').value = '';
}

function deletePost(postId) {
    const index = posts.findIndex(p => p.id === postId);
    if (index !== -1) {
        posts.splice(index, 1);
        updateFeed();
    }
}

function logout() {
    currentUser = null;
    document.getElementById('loginPage').style.display = 'flex';
    document.getElementById('mainPage').style.display = 'none';
}

function closeModal(modalId) {
    document.getElementById(modalId).style.display = 'none';
}

function addReaction(postId, type) {
    const post = posts.find(p => p.id === postId);
    if (!post.reactions) post.reactions = {};
    post.reactions[type + 's'] = (post.reactions[type + 's'] || 0) + 1;
    updateFeed();
}

function handleCommentSubmit(event, postId) {
    if (event.key === 'Enter') {
        const input = event.target;
        const post = posts.find(p => p.id === postId);
        if (!post.comments) post.comments = [];
        post.comments.push({
            user: currentUser,
            text: input.value,
            date: new Date().toLocaleString()
        });
        input.value = '';
        updateFeed();
    }
}

function showUserProfile(userId) {
    const user = users.find(u => u.id === userId);
    if (!user) return;
    
    const modal = document.getElementById('userProfileModal');
    const content = document.getElementById('userProfileContent');
    const blockSection = document.getElementById('blockUserSection');
    
    content.innerHTML = `
        <img src="${user.profilePic || 'https://via.placeholder.com/100'}" 
             style="width: 100px; height: 100px; border-radius: 50%;">
        <h3>${user.name || user.id}</h3>
        <p>Data de Nascimento: ${user.birth || 'Não informado'}</p>
        <p>Idade: ${user.age || 'Não informado'}</p>
        <p>Perfil Smule: ${user.smule || 'Não informado'}</p>
    `;
    
    if (!user.isAdmin && user.id !== currentUser.id) {
        const isBlocked = currentUser.blockedUsers?.includes(user.id);
        blockSection.innerHTML = `
            <button class="btn" onclick="toggleBlockUser('${user.id}')">
                ${isBlocked ? 'Desbloquear' : 'Bloquear'} Usuário
            </button>
        `;
    } else {
        blockSection.innerHTML = '';
    }
    
    modal.style.display = 'block';
}

function toggleBlockUser(userId) {
    if (!currentUser.blockedUsers) currentUser.blockedUsers = [];
    
    const index = currentUser.blockedUsers.indexOf(userId);
    if (index === -1) {
        currentUser.blockedUsers.push(userId);
        alert('Usuário bloqueado com sucesso!');
    } else {
        currentUser.blockedUsers.splice(index, 1);
        alert('Usuário desbloqueado com sucesso!');
    }
    
    updateFeed();
    closeModal('userProfileModal');
}

function reportPost(postId) {
    alert('Post denunciado! Um administrador irá analisar.');
}

function showProfileModal() {
    const modal = document.getElementById('profileModal');
    const user = currentUser;
    
    document.getElementById('profileName').value = user.name || '';
    document.getElementById('profileBirth').value = user.birth || '';
    document.getElementById('profileAge').value = user.age || '';
    document.getElementById('profileSmule').value = user.smule || '';
    
    if (user.profilePic) {
        document.getElementById('profilePreview').src = user.profilePic;
        document.getElementById('profilePreview').style.display = 'block';
    }
    
    modal.style.display = 'block';
}

function saveProfile() {
    const fileInput = document.getElementById('profilePic');
    const file = fileInput.files[0];
    
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            currentUser.profilePic = e.target.result;
            updateFeed();
        };
        reader.readAsDataURL(file);
    }
    
    currentUser.name = document.getElementById('profileName').value;
    currentUser.birth = document.getElementById('profileBirth').value;
    currentUser.age = document.getElementById('profileAge').value;
    currentUser.smule = document.getElementById('profileSmule').value;
    
    const userIndex = users.findIndex(u => u.id === currentUser.id);
    if (userIndex !== -1) {
        users[userIndex] = {...users[userIndex], ...currentUser};
    }
    
    updateFeed();
    closeModal('profileModal');
}

document.getElementById('profilePic').onchange = function(e) {
    const file = e.target.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            document.getElementById('profilePreview').src = e.target.result;
            document.getElementById('profilePreview').style.display = 'block';
        };
        reader.readAsDataURL(file);
    }
};

function handleFileUpload() {
    const input = document.createElement('input');
    input.type = 'file';
    input.accept = 'image/*';
    input.onchange = (e) => {
        const file = e.target.files[0];
        // Handle file upload logic here
    };
    input.click();
}

function handleTextPost() {
    document.getElementById('postText').focus();
}

function showRadioPlayer() {
    document.getElementById('radioModal').style.display = 'block';
}

function confirmYouTube() {
    document.getElementById('youtubeConfirmModal').style.display = 'block';
}

function openYouTube() {
    window.open('https://www.youtube.com/@apeministerio', '_blank');
    closeModal('youtubeConfirmModal');
}

updateRealTime();
</script>
</body>
</html>